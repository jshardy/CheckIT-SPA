<html>
<head>
  <title>New Invoice</title>
</head>

<body>
  <div id="page-wrap">
    <div id="header">
      <h1>INVOICE</h1>
    </div>

    <!-- Person the invoice is mailed to -->
    <div class="customerName">
      <div class="alert alert-danger" *ngIf="customerNotFound">Customer not found.</div>
      <input *ngIf="customerAddress === null" [(ngModel)]="selectedCustomerName"
            [typeahead]="customerData"
            typeaheadOptionField="firstLastName"
            [typeaheadOptionsInScrollableView]="5"
            [typeaheadScrollable]="true"
            (typeaheadOnSelect)="onCustomerSelect($event)"
            class="form-control">
            <div>
              <button id="btnNewCustomer" type="button" *ngIf="customerAddress === null" class="btn btn-outline-danger btn-group mr-3">New Customer</button>
              <button id="btnCancelCustomerSelection" type="button" *ngIf="customerAddress != null" (click)="this.customerAddress = null" class="btn btn-outline-danger btn-group mr-3">Cancel Customer</button>
            </div>
    </div>

    <div id="identity">
        <!-- This has autodetect for company first then name -->
      <address id="address" *ngIf="customerAddress != null" enabled="false">
        <strong>{{ selectedCustomerName }}</strong>,<br>
        {{ customerAddress?.street }},<br>
        {{ customerAddress?.city }}, {{ customerAddress?.state }}, {{ customerAddress?.zipCode }}<br>
        {{ selectedCustomer?.phoneNumber }}
      </address>

      <div id="logo">
          <!-- Logo goes here -->
        <i class="fa fa-check"></i>
      </div>
    </div>

    <!-- Empty space between title and items list -->
    <div style="clear:both"></div>

    <div id="customer">
      <table id="meta">
        <tr>
          <td class="meta-head">Date</td>
          <td><textarea id="date" [(ngModel)]="currentDate">{{ currentDate | date }}</textarea></td>
        </tr>
        <tr>
          <td class="meta-head">Amount Due</td>
          <td>
            <div class="due"><textarea id="totalDue">${{ totalDue }}</textarea></div>
          </td>
        </tr>
      </table>
    </div>

    <table id="items">
      <tr>
        <th>Item</th>
        <th>Description</th>
        <th>Unit Cost</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Delete</th>
      </tr>

      <!-- Quantity Rows  -->
      <tr class="item-row" *ngFor="let item of items;">
        <td class="item-name">
          <div class="delete-wpr">
            <textarea [(ngModel)]="item.name">{{ item.name }}</textarea>
          </div>
        </td>
        <td class="description">
          <textarea [(ngModel)]="item.description">{{ item.description }}</textarea>
        </td>
        <td>
          <textarea class="cost" [(ngModel)]="item.price" (onchange)='priceChanged()'>{{ item.price }}</textarea>
        </td>
        <td>
          <textarea class="qty" [(ngModel)]="item.quantity" (onchange)='priceChanged()'>{{ item.quantity }}</textarea>
        </td>
        <td>
          <span class="price">{{ item.price * item.quantity | currency }}</span><br>
        </td>
        <td>
          <span class="price" (click)='deleteRow(item)'>X</span>
        </td>
      </tr>

      <!-- <tr id="hiderow"> -->
      <tr>
        <td colspan="6"><a id="addrow" title="Add a row" (click)='addNewRow();'>Add a row</a></td>
      </tr>

      <tr>
        <td colspan="2" class="blank"> </td>
        <td colspan="2" class="total-line">Subtotal</td>
        <td class="total-value">
          <div id="subtotal" [(ngModel)]="subTotal">{{ subTotal | currency }}</div>
        </td>
      </tr>

      <tr>
        <td colspan="2" class="blank"> </td>
        <td colspan="2" class="total-line">Total</td>
        <td class="total-value">
          <div id="total">{{ totalDue | currency }}</div>
        </td>
      </tr>

      <tr>
        <td colspan="2" class="blank"> </td>
        <td colspan="2" class="total-line">Amount Paid</td>
        <td class="total-value"><textarea id="paid">$0.00</textarea></td>
      </tr>

      <tr>
        <td colspan="2" class="blank"> </td>
        <td colspan="2" class="total-line balance">Balance Due</td>
        <td class="total-value balance">
          <div class="due" [(ngModel)]="totalDue">{{ totalDue | currency }}</div>
        </td>
      </tr>
    </table>

    <div id="terms">
      <h5>Terms</h5>
      <textarea>Finance Charge of 1.5% will be made on unpaid balances after 30 days.</textarea>
    </div>
  </div>

  <!-- Test data section -->
  <div>
    <p></p><p></p><p></p>
    <label>Test Data</label>
    <pre>{{ customerData | json }}</pre>
  </div>
</body>
</html>
